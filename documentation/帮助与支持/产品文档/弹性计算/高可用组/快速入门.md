**快速入门**

完整地使用京东云可用组部署高可用业务，您需要按照以下四步来完成：

![image.png](https://img1.jcloudcs.com/cms/61ca55b8-9086-4ed9-a8b4-46c393faf6c620180424161025.png)

## 第一步：创建实例模板

实例模板定义了高可用组内云主机的配置信息，包括镜像、云主机规格、系统盘及数据盘类型和容量、私有网络及子网配置、安全组及登录信息等。

前提条件：

* 
您可预先创建[私有网络](https://www.jcloud.com/help/detail/1527/isCateLog/1)、[子网](https://www.jcloud.com/help/detail/1542/isCateLog/1)或随云主机一起创建私有网络及子网；
* 
若您需要在Linux云主机上使用SSH密钥登录实例，您可预先[创建SSH密钥](https://www.jcloud.com/help/detail/330/isCateLog/1)或随云主机一起创建SSH密钥；
* 
若您需要使用安全组进行云主机的安全访问控制，您可预先[创建安全组](https://www.jcloud.com/help/detail/1486/isCateLog/1)、配置安全组或随云主机一起创建安全组。

创建步骤

1. 
打开控制台，选择 弹性计算>>云主机>>实例模板
1. 
选择需要创建实例模板的地域
1. 
点击【创建】，进入实例模板创建页面
1. 
选择地域：在此步骤仍可以选择新建实例模板对应的地域（华北-北京、华南-广州、华东-宿迁及华东-上海），请注意**不可跨地域使用实例模板**，例不支持使用华南-广州地域的实例模板创建云主机。如果所选地域限额已满，可以通过[提交工单](https://uc.jcloud.com/question/submit)提升限额。
1. 
设置实例模板名称、描述，例：Web服务实例模板
1. 
选择镜像，高可用组内云主机均将以该镜像创建。

对于初次使用京东云的用户可以选择京东云提供的“官方镜像”，您可以根据需要选择对应的系统，并选择合适的版本，但您需要手动对新增机器部署应用环境。

对于已经对部署业务进行过完整测试，建议您基于测试机制作私有镜像后使用私有镜像配置实例模板，同时建议您将镜像内应用设置成自启动，以保证高可用组内云主机可实现自动化负载业务，参考：配置开机自启动。

![image.png](https://img1.jcloudcs.com/cms/fa475960-4843-46d7-99a6-424d3559324f20180424170811.png)
1. 
选择规格：京东云云主机规格支持用户自定义选择：用户可以根据不同业务场景选择实例规格及相应配置，详细请查阅[实例规格类型](http://www.jcloud.com/help/detail/302/isCateLog/1)。

![image.png](https://img1.jcloudcs.com/cms/55487407-9b98-43d8-a406-2b9582c1e21720180424170900.png)

**请注意：**若您计划使用该实例模板创建高可用组，您需要选择第二代规格，如g.n2.large
1. 
选择存储：京东云提供云硬盘和本地硬盘两种类型。
云硬盘：采用一盘多备的分布式存储方式，数据可靠性高

本地盘：处在云服务器所在的物理机上的存储设备，可以获得较低的时延，但存在单点丢失风险。

云主机系统盘：仅支持本地盘赠送40GB。

云主机数据盘：支持挂载四块数据盘，可选高效云盘和SSD云盘，云硬盘挂载到云主机后，需要进入云主机操作系统挂载云硬盘。

高效云盘做数据盘：支持范围20G~3000G

SSD云盘做数据盘：支持范围20G~1000G

您可以随实例创建指定类型和容量的空盘，也可以基于已有云硬盘快照创建数据盘（基于快照创建的数据盘类型暂不支持调整，容量调整范围下限为快照容量），如您选择的私有镜像中包含了预设的数据盘配置信息，则选择私有镜像后会自动按照镜像中的设备映射信息配置数据盘，如您仅希望使用镜像的部分默认配置，也可以对其进行删减（不支持在默认配置上更换快照，如欲更换快照请删除默认配置后单独添加新盘后选择快照）。关于数据盘设备名分配规则请查阅[设备名分配规则](https://www.jdcloud.com/help/detail/2263/isCatalog/1)。
![image.png](https://img1.jcloudcs.com/cms/251d9d6a-005a-40be-9540-c39f8449f63520180424170935.png)
1. 
选择网络：您需选择“私有网络”及“子网”，选择子网后，可以判断该子网下，还有可以创建的云主机数量，如果暂时没有子网，可以通过快速入口新建子网，并在“云主机网络”进行选择，详细请查阅[私有网络](http://www.jcloud.com/help/detail/1509/isCateLog/1)[和](http://www.jcloud.com/help/detail/464/isCateLog/1)[子网](http://www.jcloud.com/help/detail/1510/isCateLog/1)[。](http://www.jcloud.com/help/detail/464/isCateLog/1)

选择对应的已创建的安全组，安全组为必选项，安全组也可以通过快速入口创建，详细请查阅[创建安全组](http://www.jcloud.com/help/detail/1486/isCateLog/1)，完成创建后，在“网络”进行选择。

![image.png](https://img1.jcloudcs.com/cms/ee19bd15-c6da-4a42-8226-0d610645e81120180424171001.png)
1. 
选择公网带宽：

京东云提供的公网IP带宽类型为按固定带宽计费及按使用流量计费，按固定带宽计费按购买时设置的带宽上限值计费，而与您云主机当前实时访问公网带宽无关，按使用流量计费则根据您实时访问公网的实际流量计费。线路分为：BGP和非BGP，若您需要更快更高效的网络接入请选用BGP。

带宽范围为：1Mbps~200Mbps，支持可以暂不配置公网IP，使用实例模板创建云主机后，再另行购买绑定。

![image.png](https://img1.jcloudcs.com/cms/9717d628-00ba-4f87-8ab1-a4d37f9cf7aa20180424171030.png)
1. 
选择登录方式：

对于Windows系统，登录用户名为administrator；对于Linux系统，登录用户名为root；

对于登录密码，可以选择“立即设置”或“暂不设置”，若选择“暂不设置”，在使用实例模板创建云主机时系统会以短信和邮件方式发送随机密码，建议您创建云主机完成后通过控制台修改密码。

此外，对于Linux系统，可以选择SSH密钥登录，通过绑定已经创建的SSH密钥进行更安全的实例登录认证，详细SSH密钥创建及登录帮助，请参考[SSH密钥](http://www.jcloud.com/help/detail/329/isCateLog/1 "SSH密钥")。![image.png](https://img1.jcloudcs.com/cms/70a3e510-d35c-4a01-b4e9-dfe5ea12876620180424171056.png)
1. 
**实例模板免费**，页面右侧将显示您已配置的信息，同时会展示根据您的配置，基于此实例模板创建一台云主机的预估费用，包括包年包月计费情况下每月费用及按配置计费情况下每小时费用。费用包括云硬盘及按固定带宽计费公网IP的费用，若您选择按流量计费公网IP则将单独列出。
云主机计费方式公网带宽计费方式费用估算按配置按固定带宽配置费用，包括：实例规格（CPU 和内存的配置）、数据盘（如果有）、和公网IP带宽的费用。按使用流量公网流量费用 + 配置费用。其中，配置费用包括：实例规格（CPU 和内存的配置）、数据盘（如果有）的费用及公网IP配置费。包年包月按固定带宽配置费用，包括：实例规格（CPU 和内存的配置）、数据盘（如果有）、和公网IP带宽的费用。按使用流量公网流量费用 + 配置费用。其中，配置费用包括：实例规格（CPU 和内存的配置）、数据盘（如果有）的费用及公网IP配置费。
1. 
点击【立即创建】，触发创建实例模板，您将在实例模板列表页看到创建成功的实例模板

**第二步：创建高可用组**

高可用组是京东云提供面向同一场景的云主机逻辑集合，高可用组内的云主机分散部署在相互隔离的物理资源上，当出现硬件故障或定时维护时只会影响部分云主机，您的业务仍为可用状态。

1. 
打开控制台，选择 弹性计算>>高可用组；
1. 
选择需要创建高可用组的地域，注意请确保已创建的启动配置也位于该地域；
1. 
点击【创建】，弹出创建高可用组弹窗；
1. 
选择地域，默认为您在列表页选择的地域，在此步骤仍可以更换新建高可用组对应的地域（华北-北京、华南-广州、华东-宿迁及华东-上海）。如果所选地域限额已满，可以通过[提交工单](https://uc.jcloud.com/question/submit)提升限额；
1. 
设置高可用组的可用区属性，为保障最优的业务可用性，建议选择多可用区。高可用组内云主机将在高可用组内均匀分布。降低当单个可用区出现物理故障时对您业务的影响；
1. 
设置高可用组名称及描述，如：Web服务高可用组；
1. 
选择实例模板，下拉框将列出当前地域下满足条件的实例模板，请注意需选择配置了第二代云主机规格的实例模板，此处选择上一步创建的“Web服务实例模板”；
1. 
点击【确定】触发创建高可用组，您将在高可用组列表页看到创建成功的高可用组。

**第三步：新增云主机**

当选择高可用组来部署业务时，需要向高可用组内新增云主机，高可用组不支持添加已创建的云主机，故新增云主机即新建云主机。创建云主机需先进行实名认证，若您需要创建按配置计费的云主机，您还需要保证您账户余额+可用代金券需大于50元。

1. 
打开控制台，选择弹性计算>>高可用组；
1. 
可使用搜索功能找到对应高可用组；
1. 
点击【新增云主机】，将跳转至云主机创建页面，且创建方式为“在高可用组内创建”，对应高可用组选中为对应高可用组，如：Web服务高可用组。将根据高可用组所关联的实例模板内配置的信息匹配至当前页面。但需注意这些配置信息不允许修改；
1. 
您可以选择不同计费类型及购买数量，计费类型氛围包年包月或按配置计费，若购买包年包月云主机您需要指定购买时长。
1. 
若您单次仅新增一台云主机，则您还可以指定其内网IP地址，需注意的是内网地址需在对应子网CIDR范围内；
1. 
设置云主机名称及描述；
1. 
完成以上配置后，点击【立即购买】，对于包年包月云主机完成之后及可在高可用组详情页或云主机列表页查看创建的云主机，对于按配置计费云主机则将直接触发创建。云主机从创建到可用将有几分钟时间，还请耐心等待。

若高可用组关联的启动木南木配置了已经部署好业务且配置了开机自启动的私有镜像，当您完成新增云主机时可认为您获得了一组可对外服务的且高可用的云主机组。

**第四步：开启自动伸缩（可选）**

高可用组开启自动伸缩后，可设置基于监控指标（如CPU、内存利用率）配置的告警策略以及预先设置时间，到预设时间后自动伸缩的定时策略来进行云主机数量的增减，以应对业务负载波动情况。

1. 
打开控制台，选择 弹性计算>>高可用组；
1. 
可使用搜索功能找到对应高可用组名称，点击右侧【开启自动伸缩】
1. 
您需要指定高可用组的最小实例数、最大实例数及移除策略。高可用组内云主机数将维持在最小伸缩数与最大伸缩数之间。若当前高可用组内云主机数小于最小实例数，高可用组将自动新增云主机，使其等于最小实例数，需要注意的是自动新增的云主机均为按配置计费；若当前高可用组内云主机数大于最大实例数，高可用组将自动按照移除策略移除云主机，使其等于最大实例数，需要注意的是自动移除的云主机将直接删除，不同于您手动移除，同时不会自动移除包年包月云主机；
1. 
点击【确定】则触发开启自动伸缩。

开启自动伸缩后，您还可以配置告警策略和定时策略。

**创建告警任务**

1. 
在高可用组详情页自动伸缩tab页内选择【告警策略】选项卡，点击【添加】；
1. 
在添加弹窗设置告警策略，基于监控性能指标（如CPU、内存等），自动为高可用组增加或减少指定台数的云主机。

![image.png](https://img1.jcloudcs.com/cms/ac020bca-e2fc-4022-b9cb-f538410adb9e20180424171939.png)

完成设置后，该告警策略将显示在页面的列表中，示例如下：![image.png](https://img1.jcloudcs.com/cms/df9bc34c-6173-4b61-acf9-3857b11b535220180424171757.png)

**创建定时任务**

1. 
在高可用组详情页自动伸缩tab页内选择【告警策略】选项卡，点击【添加】；
1. 
在添加弹窗指定定时策略名称、执行时间和伸缩规则等信息。您也可以勾选【重复任务】以定义周期定时执行任务。

![image.png](https://img1.jcloudcs.com/cms/a0acd23a-360a-40d0-b776-2408aab9db0320180424172027.png)

完成设置后，该定时策略将显示在页面的列表中，示例如下：

![image.png](https://img1.jcloudcs.com/cms/fbf092e9-bd37-4abb-8800-f584144aa80a20180424172104.png)